<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>GITHUB API DEMO</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.2/normalize.min.css">
    
    <style type="text/css">

    </style>

</head>
<body>
  <!-- GLOBAL NAV -->
<header class="navbar navbar-static-top" id="top" role="banner">
  <div class="container">
      <ul class="nav navbar-nav">
        <li><a href="">Expo</a></li>
        <li><a href="">Blog</a></li>
      </ul>
    </nav>
  </div>
</header>
    <div class="container" ng-app="App" id="content">
        <div ng-controller="Controller" class="">
            <form>
                <div class="form-group">
                    <label for="username"><b>Search Github by Username</b></label>
                    <input type="text" class="form-control" ng-model="username" placeholder="Enter Username"></input>
                </div>
            </form>
 
            <table class="table table-bordered" ng-if="events">
                <thead>
                    <tr>
                        <th>Login</th>
                        <th>Repo Name</th>
                        <th>Organization Login</th>
                        <th>Description</th>
                     </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="event in events">
                        <td><img ng-src="{{event.actor.avatar_url}}" width="30">&nbsp; {{event.actor.login}}</td>
                        <td>{{event.repo.name}}</td>
                        <td><img ng-src="{{event.org.avatar_url}}" width="30">&nbsp; {{event.org.login}}</td>
                        <td>{{event.payload.forkee.description}}</td>
                      </tr>
                </tbody>
        </table>
        </div>
    </div>

    <script>

    angular.module('Services',[])
    .factory('githubService',  function($http){
        var getUserSelection = function(username) {
            return $http({
                method: 'JSONP',
                url: 'https://api.github.com/users/'+username+'/events?callback=JSON_CALLBACK'
            })
        };
        return {
            event: function(username){
                return getUserSelection(username);
            }
        }
       
    });
       
    
    var app = angular.module('App', ['Services']); 
    app.controller('Controller',  function($scope, githubService){
        $scope.events = null;
        $scope.$watch('username', function(newUsername){
            if(newUsername){
                githubService.event(newUsername).success(function(data,status){
                    if(data.data.length !== 0){
                        $scope.events = data.data;
                    } else {
                        $scope.events = null;
                    }
                });
            }
        });
        
    });

    </script>
</body>
</html>